#!/usr/bin/env bash

echo "=== pdflatex $@ ==="
pwd
# force buffer to be flushed
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................

echo "=== pdflatex $@ ===" >&2
pwd >&2
# force buffer to be flushed
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2

exec &>/tmp/logg

(
echo "=== pdflatex $@ ==="
echo script= "$@"
cat "$0" || false
echo END
pwd
ls
mkdir -p /tmp/ltx
for arg in "$@"; do
  echo
  echo
  echo
  echo
  echo
  echo ZZZZZZZZZZZZZZZZZZZZZZZY
  echo "$arg"
  echo
  echo
  echo
  echo
  echo
  if test -f "$arg"; then
    echo contents of "$arg"
    (cat "$arg" | base64) || false
    cat "$arg" || false
  fi
done
echo "=== starting pdflatex ==="
) || true
exec PLACEHOLDER "$@"
