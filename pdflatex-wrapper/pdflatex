#!/usr/bin/env bash

echo "=== pdflatex $@ ==="
pwd
# force buffer to be flushed
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................
echo ....................................................................................................

echo "=== pdflatex $@ ===" >&2
pwd >&2
# force buffer to be flushed
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2
echo .................................................................................................... >&2

exec &>/tmp/logg

(
echo "=== pdflatex $@ ==="
echo script= "$@"
cat "$0" || false
echo END
pwd
ls
mkdir -p /tmp/ltx
for arg in "$@"; do if test -e "$arg"; then cp -- "$arg" /tmp/ltx/; fi; done
echo "=== starting pdflatex ==="
) || true
exec PLACEHOLDER "$@"
